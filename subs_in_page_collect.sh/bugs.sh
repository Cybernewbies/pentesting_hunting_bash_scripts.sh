#!/bin/bash

# Coloring : echo "$(tput setaf 1)Shirt red $(tput setaf 4) Pant blue"
# This script is only getting valid subdomains in the page

# if [[ $# -eq 0 ]]
if [[ $1 == "" ]]
	then
		echo "To use: bash bash1.sh <domain-name>"
		echo "Ex. bash bash1.sh www.megacorpone.com"
else
	echo "Starting Working on $1 .."
	# Starting The Script Idea

	if [[ -f ./index.html ]]; then rm ./index.html; fi
	if [[ -f ./subs.txt ]]; then rm ./subs.txt ;fi
	if [[ -f ./valid_subs.txt ]]; then rm ./valid_subs.txt; fi

	wget -q $1
	cat index.html | grep "href=" | cut -d "/" -f 3 | grep $(echo $1 | sed "s/www.//g") | cut -d '"' -f 1 | grep -v "www." | uniq >> subs.txt
	
	# Checking Valid Subdomains
	for sub in $(cat subs.txt);
		do
			if [[ $(ping -c 1 $sub 2> /dev/null) ]]
				then
					IPA=$(host $sub | head -n 1 | cut  -d " " -f 4)
					echo "$sub ->> $IPA" >> valid_subs.txt
					echo "Found: $sub"
				else
					echo "Error: $sub"
			fi
	done

	if [[ -f ./index.html ]]; then rm ./index.html; fi
	if [[ -f ./subs.txt ]]; then rm ./subs.txt ;fi

fi
